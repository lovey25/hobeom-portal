# 설정 앱 테스트 가이드

## 🧪 테스트 체크리스트

### 1. 프로필 설정 테스트

#### 이름 변경

- [ ] 이름 필드에 새로운 이름 입력
- [ ] "프로필 저장" 버튼 클릭
- [ ] "프로필이 업데이트되었습니다" 알림 확인
- [ ] 대시보드 헤더에서 변경된 이름 확인

#### 이메일 변경

- [ ] 이메일 필드에 새 이메일 입력
- [ ] "프로필 저장" 버튼 클릭
- [ ] 성공 알림 확인
- [ ] 중복된 이메일로 시도 → 오류 메시지 확인

#### 비밀번호 변경

- [ ] 현재 비밀번호 입력
- [ ] 새 비밀번호 입력 (6자 이상)
- [ ] 새 비밀번호 확인 입력
- [ ] "비밀번호 변경" 버튼 클릭
- [ ] 성공 알림 확인
- [ ] 로그아웃 후 새 비밀번호로 로그인 테스트

**예상 오류 케이스:**

- 현재 비밀번호 불일치
- 새 비밀번호 6자 미만
- 새 비밀번호와 확인이 다름

### 2. 표시 설정 테스트

#### 대시보드 열 개수

- [ ] 3열 선택 후 저장
- [ ] 대시보드 페이지로 이동하여 새로고침
- [ ] 앱 그리드가 3열로 표시되는지 확인
- [ ] 4/5/6열도 동일하게 테스트

#### 카드 크기

- [ ] "작게" 선택 후 저장
- [ ] 대시보드 새로고침
- [ ] 앱 카드 크기 확인 (작은 아이콘, 작은 텍스트)
- [ ] "보통", "크게"도 동일하게 테스트

#### 미리보기

- [ ] 열 개수 변경 시 미리보기 그리드 업데이트 확인
- [ ] 카드 크기 변경 시 미리보기 카드 크기 확인

### 3. 할일 설정 테스트

#### 초기화 시간

- [ ] 다른 시간 선택 (예: 06:00)
- [ ] 저장 버튼 클릭
- [ ] 새로고침 후 값이 유지되는지 확인
- [ ] (향후 구현) 실제 초기화 동작 확인

#### 주말 제외 옵션

- [ ] 체크박스 토글
- [ ] 저장 버튼 클릭
- [ ] 새로고침 후 상태 유지 확인

#### 통계 기간

- [ ] 7일로 변경 후 저장
- [ ] 90일로 변경 후 저장
- [ ] 값 범위 검증 (7-90)

#### 목표 완료율

- [ ] 50%로 변경 후 저장
- [ ] 100%로 변경 후 저장
- [ ] 값 범위 검증 (50-100)

### 4. 알림 설정 테스트

- [ ] 할일 알림 토글 ON/OFF
- [ ] 여행 준비 알림 토글 ON/OFF
- [ ] 이메일 알림 토글 ON/OFF
- [ ] 각 설정 저장 후 새로고침하여 상태 유지 확인

### 5. 통합 테스트

#### 대시보드 연동

```bash
# 테스트 시나리오
1. 설정 페이지에서 "5열 + 크게" 선택
2. 저장
3. 대시보드로 이동
4. 새로고침 (F5)
5. 앱 그리드가 5열 + 큰 카드로 표시되는지 확인
```

#### 다중 사용자 테스트

```bash
# 사용자 1
1. admin 계정으로 로그인
2. 설정: 4열 + 보통
3. 저장 후 대시보드 확인

# 사용자 2
1. user1 계정으로 로그인
2. 설정: 6열 + 작게
3. 저장 후 대시보드 확인

# 격리 확인
각 사용자의 설정이 독립적으로 유지되는지 확인
```

### 6. 데이터 지속성 테스트

- [ ] 설정 변경 후 저장
- [ ] 브라우저 닫기
- [ ] 다시 열어서 로그인
- [ ] 설정 페이지에서 이전 설정값이 유지되는지 확인
- [ ] 대시보드에서 설정이 반영되는지 확인

### 7. CSV 파일 확인

```bash
# 설정 저장 후 CSV 파일 확인
cat data/user-settings.csv

# 예상 출력:
# id,user_id,category,key,value,updated_at
# 1,1,display,dashboardColumns,5,2024-01-15T10:00:00.000Z
# 2,1,display,cardSize,large,2024-01-15T10:00:00.000Z
```

### 8. API 테스트

#### GET /api/settings

```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  http://localhost:3000/api/settings
```

#### POST /api/settings

```bash
curl -X POST \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"display":{"dashboardColumns":5}}' \
  http://localhost:3000/api/settings
```

#### PUT /api/settings/profile

```bash
curl -X PUT \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"새이름","email":"new@example.com"}' \
  http://localhost:3000/api/settings/profile
```

#### PUT /api/settings/password

```bash
curl -X PUT \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"currentPassword":"password","newPassword":"newpass123"}' \
  http://localhost:3000/api/settings/password
```

## 🐛 알려진 이슈 및 제한사항

### 현재 구현된 기능

- ✅ 설정 CRUD 완전 구현
- ✅ 프로필 업데이트 (이름, 이메일)
- ✅ 비밀번호 변경
- ✅ 대시보드 열 개수 반영
- ✅ 카드 크기 반영
- ✅ 실시간 미리보기

### 향후 구현 필요

- ⏳ 할일 초기화 시간 실제 적용 (스케줄러 필요)
- ⏳ 주말 제외 옵션 실제 적용
- ⏳ 통계 기간 설정 반영
- ⏳ 목표 완료율 시각화
- ⏳ 알림 기능 실제 구현
- ⏳ 언어 설정 (i18n)

## 📊 성능 테스트

### 설정 로딩 시간

- 초기 로딩: < 500ms (예상)
- 설정 저장: < 1000ms (예상)
- 대시보드 반영: 즉시 (새로고침 필요)

### 데이터 크기

- 사용자당 설정 항목: ~10-15개
- CSV 파일 크기: 사용자 100명 기준 ~20KB

## 🔍 디버깅 팁

### 브라우저 개발자 도구

```javascript
// 로컬스토리지 확인
console.log(document.cookie);

// 설정 API 직접 호출
const token = "YOUR_TOKEN";
fetch("/api/settings", {
  headers: { Authorization: `Bearer ${token}` },
})
  .then((r) => r.json())
  .then(console.log);
```

### 서버 로그

```bash
# 개발 서버 실행 시 API 호출 로그 확인
npm run dev

# 설정 저장 시 콘솔에 출력되는 로그 확인
```

### CSV 파일 수동 편집

```bash
# 설정 파일 백업
cp data/user-settings.csv data/user-settings.backup.csv

# 수동 편집 (주의: 형식 준수)
nano data/user-settings.csv

# 문제 발생 시 복원
cp data/user-settings.sample.csv data/user-settings.csv
```

## ✅ 통과 기준

모든 체크리스트 항목이 통과되어야 설정 앱이 정상 작동하는 것으로 판단합니다.

### 필수 테스트 (Must Pass)

- [x] 프로필 업데이트
- [x] 비밀번호 변경
- [x] 대시보드 열 개수 반영
- [x] 카드 크기 반영
- [x] 설정 지속성 (재로그인 후 유지)

### 권장 테스트 (Should Pass)

- [x] 미리보기 정상 동작
- [x] 다중 사용자 설정 격리
- [x] API 응답 시간 < 1초

### 향후 테스트 (Nice to Have)

- [ ] 할일 초기화 시간 적용
- [ ] 주말 제외 동작
- [ ] 알림 기능

## 📝 테스트 결과 기록

```
테스트 날짜: ___________
테스트 환경: Node.js _____ / Next.js _____
테스트자: ___________

✅ 통과 / ❌ 실패

[ ] 1. 프로필 설정
  [ ] 이름 변경
  [ ] 이메일 변경
  [ ] 비밀번호 변경

[ ] 2. 표시 설정
  [ ] 열 개수 (3/4/5/6)
  [ ] 카드 크기 (작게/보통/크게)
  [ ] 미리보기

[ ] 3. 할일 설정
  [ ] 초기화 시간
  [ ] 주말 제외
  [ ] 통계 기간
  [ ] 목표 완료율

[ ] 4. 알림 설정
  [ ] 할일 알림
  [ ] 여행 준비 알림
  [ ] 이메일 알림

[ ] 5. 통합 테스트
  [ ] 대시보드 연동
  [ ] 다중 사용자

[ ] 6. 데이터 지속성

특이사항:
___________________________
___________________________
___________________________
```
