# 📋 오늘의 할일 (Daily Tasks)

매일 해야 할 일들을 관리하고 완료율을 추적하는 앱입니다.

## 🎯 주요 기능

### 사용자 기능

- **할일 관리**: 매일 해야 할 일들을 등록, 수정, 삭제
- **중요도 설정**: 3단계 중요도 (⭐ 낮음, ⭐⭐ 보통, ⭐⭐⭐ 높음)
- **대시보드 카드**: 대시보드에서 오늘의 할일 및 완료율 확인
- **완료 체크**: 클릭 한 번으로 할일 완료/미완료 토글
- **완료율 추적**: 최근 30일간의 완료율 그래프
- **통계**: 등록된 할일 수, 최근 7일 평균 완료율, 연속 기록일

### 관리자 기능

- **전체 현황**: 모든 사용자의 할일 현황 조회
- **날짜별 조회**: 특정 날짜의 현황 확인
- **사용자별 상세**: 각 사용자의 할일 목록 및 완료 상태 확인
- **통계 대시보드**: 평균 완료율, 우수 사용자, 개선 필요 사용자 수

## 💾 데이터 구조

### daily-tasks.csv

할일 템플릿 (사용자가 등록한 할일 목록)

```csv
id,user_id,title,description,importance,is_active,created_at
1,1,아침 운동,30분 조깅 또는 스트레칭,3,true,2025-10-10T09:00:00Z
```

### daily-task-logs.csv

일일 완료 로그

```csv
id,user_id,task_id,date,is_completed,completed_at
1,1,1,2025-10-12,true,2025-10-12T07:30:00Z
```

### daily-stats.csv

일일 통계 (히스토리)

```csv
id,user_id,date,total_tasks,completed_tasks,completion_rate,created_at
1,1,2025-10-11,3,3,100.00,2025-10-11T23:59:59Z
```

## 🔄 자동 리셋 시스템

### 동작 방식

1. 사용자가 앱에 접속하면 마지막 접속 날짜와 오늘 날짜를 비교
2. 날짜가 다르면 **마지막 접속일부터 어제까지** 각 날짜의 완료율을 자동으로 기록
3. 오늘 날짜의 할일 로그를 새로 생성 (모두 미완료 상태)

### 예시

- **10/10** 마지막 접속 (완료율 80%)
- **10/11~10/13** 접속 안함
- **10/14** 재접속
  - → 10/10, 10/11, 10/12, 10/13의 완료율이 각각 기록됨
  - → 10/14의 새 할일 로그 생성

### 구현 위치

- API: `/api/daily-tasks/today` (GET 요청 시 `lastAccessDate` 파라미터 사용)
- 함수: `resetDailyTasksForUser()` in `src/lib/data.ts`
- 클라이언트: `TodayTaskCard` 컴포넌트에서 localStorage 활용

## 🛠️ API 엔드포인트

### 할일 관리

- `GET /api/daily-tasks` - 할일 목록 조회
- `POST /api/daily-tasks` - 할일 추가
- `PUT /api/daily-tasks` - 할일 수정
- `DELETE /api/daily-tasks?taskId=xxx` - 할일 삭제

### 오늘의 할일

- `GET /api/daily-tasks/today?date=YYYY-MM-DD&lastAccessDate=YYYY-MM-DD` - 오늘의 할일 및 완료 상태 (리셋 포함)
- `PATCH /api/daily-tasks/today` - 완료 상태 토글

### 통계

- `GET /api/daily-tasks/stats?startDate=YYYY-MM-DD&endDate=YYYY-MM-DD` - 일일 통계 조회

### 관리자

- `GET /api/daily-tasks/all-users?date=YYYY-MM-DD` - 전체 사용자 현황 (관리자 전용)

## 🎨 UI 컴포넌트

### TodayTaskCard

대시보드에 표시되는 접을 수 있는 카드

- 위치: `src/components/TodayTaskCard.tsx`
- 기능:
  - 완료율 진행 바 (●●●○○)
  - 할일 목록 및 체크박스
  - 접기/펴기 (localStorage 저장)
  - 할일 관리 페이지로 이동 버튼

### 사용자 페이지

할일 등록/수정/삭제 및 통계 확인

- 위치: `/dashboard/daily-tasks`
- 기능:
  - 할일 CRUD
  - 중요도 선택 (1~3)
  - 완료율 그래프 (최근 30일)
  - 통계 카드

### 관리자 페이지

전체 사용자 현황 조회

- 위치: `/dashboard/daily-tasks/admin`
- 기능:
  - 날짜별 조회
  - 사용자별 완료율 확인
  - 할일 상세 보기 (아코디언)
  - 통계 대시보드

## 📱 사용 방법

### 일반 사용자

1. 대시보드에서 "오늘의 할일" 카드 확인
2. 할일 완료 시 체크박스 클릭
3. "할일 관리 →" 버튼으로 상세 페이지 이동
4. "+ 할일 추가" 버튼으로 새 할일 등록
5. 그래프에서 완료율 추이 확인

### 관리자

1. 관리자 도구에서 "할일현황" 앱 클릭
2. 날짜 선택으로 특정 날짜 조회
3. 사용자별 카드 클릭으로 상세 확인
4. 통계로 전체 현황 파악

## 🔧 확장 아이디어

- [ ] 할일 카테고리 기능
- [ ] 반복 할일 설정 (매일, 주중, 주말 등)
- [ ] 알림 기능 (완료하지 않은 할일 알림)
- [ ] 월간/연간 통계 보기
- [ ] 할일 템플릿 공유
- [ ] 팀 단위 할일 관리
- [ ] 완료율 순위 (리더보드)
- [ ] 배지/업적 시스템

## 🐛 알려진 이슈

없음

## 📝 변경 이력

### v1.0.0 (2025-10-12)

- 초기 릴리즈
- 할일 CRUD 기능
- 자동 리셋 및 완료율 기록
- 대시보드 카드
- 사용자/관리자 페이지
- 완료율 그래프
